[2024-05-18T22:06:15.667+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-18T22:06:15.682+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:06:15.688+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:06:15.688+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 1
[2024-05-18T22:06:15.698+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): create_db> on 2023-01-01 00:00:00+00:00
[2024-05-18T22:06:15.707+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=67) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-18T22:06:15.708+0000] {standard_task_runner.py:63} INFO - Started process 74 to run task
[2024-05-18T22:06:15.707+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'games', 'create_db', 'scheduled__2023-01-01T00:00:00+00:00', '--job-id', '481', '--raw', '--subdir', 'DAGS_FOLDER/get_main_games.py', '--cfg-path', '/tmp/tmpqt9gb7kv']
[2024-05-18T22:06:15.709+0000] {standard_task_runner.py:91} INFO - Job 481: Subtask create_db
[2024-05-18T22:06:15.740+0000] {task_command.py:426} INFO - Running <TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [running]> on host 2ae0aa1ff24c
[2024-05-18T22:06:15.795+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='games' AIRFLOW_CTX_TASK_ID='create_db' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:00:00+00:00'
[2024-05-18T22:06:15.796+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-18T22:06:15.818+0000] {base.py:84} INFO - Using connection ID '***' for task execution.
[2024-05-18T22:06:17.701+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-18T22:06:17.701+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(games_match_id_seq, 2200) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/plugins/steps/get_matches.py", line 107, in create_db
    metadata.create_all(engine)
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 4930, in create_all
    bind._run_ddl_visitor(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3238, in _run_ddl_visitor
    conn._run_ddl_visitor(visitorcallable, element, **kwargs)
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2221, in _run_ddl_visitor
    visitorcallable(self.dialect, self, **kwargs).traverse_single(element)
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py", line 855, in visit_metadata
    self.traverse_single(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py", line 524, in traverse_single
    return meth(obj, **kw)
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py", line 899, in visit_table
    self.connection.execute(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py", line 80, in _execute_on_connection
    return connection._execute_ddl(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1477, in _execute_ddl
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(games_match_id_seq, 2200) already exists.

[SQL: 
CREATE TABLE games (
	match_id SERIAL NOT NULL, 
	gameweek_id INTEGER, 
	"gameweek_compSeason_label" VARCHAR, 
	"gameweek_compSeason_competition_abbreviation" VARCHAR, 
	"gameweek_compSeason_competition_description" VARCHAR, 
	"gameweek_compSeason_competition_level" VARCHAR, 
	"gameweek_compSeason_competition_source" VARCHAR, 
	"gameweek_compSeason_competition_id" INTEGER, 
	"gameweek_compSeason_id" INTEGER, 
	gameweek_gameweek INTEGER, 
	kickoff_completeness INTEGER, 
	kickoff_millis INTEGER, 
	kickoff_label VARCHAR, 
	"provisionalKickoff_completeness" INTEGER, 
	"provisionalKickoff_millis" INTEGER, 
	"provisionalKickoff_label" VARCHAR, 
	teams_team_1_name VARCHAR, 
	teams_team_1_club_name VARCHAR, 
	"teams_team_1_club_shortName" VARCHAR, 
	teams_team_1_club_abbr VARCHAR, 
	teams_team_1_club_id INTEGER, 
	"teams_team_1_teamType" VARCHAR, 
	"teams_team_1_shortName" VARCHAR, 
	teams_team_1_id INTEGER, 
	teams_score_1 INTEGER, 
	teams_team_2_name VARCHAR, 
	teams_team_2_club_name VARCHAR, 
	"teams_team_2_club_shortName" VARCHAR, 
	teams_team_2_club_abbr VARCHAR, 
	teams_team_2_club_id INTEGER, 
	"teams_team_2_teamType" VARCHAR, 
	"teams_team_2_shortName" VARCHAR, 
	teams_team_2_id INTEGER, 
	teams_score_2 INTEGER, 
	replay BOOLEAN, 
	ground_name VARCHAR, 
	ground_city VARCHAR, 
	ground_source VARCHAR, 
	ground_id INTEGER, 
	"neutralGround" BOOLEAN, 
	status VARCHAR, 
	phase VARCHAR, 
	outcome VARCHAR, 
	attendance INTEGER, 
	clock_secs INTEGER, 
	clock_label VARCHAR, 
	"fixtureType" VARCHAR, 
	"extraTime" BOOLEAN, 
	shootout BOOLEAN, 
	"behindClosedDoors" BOOLEAN, 
	id INTEGER, 
	team_1_formation_used INTEGER, 
	team_1_accurate_back_zone_pass INTEGER, 
	team_1_total_back_zone_pass INTEGER, 
	team_1_accurate_pass INTEGER, 
	team_1_touches INTEGER, 
	team_1_total_pass INTEGER, 
	team_1_backward_pass INTEGER, 
	team_1_successful_open_play_pass INTEGER, 
	team_1_open_play_pass INTEGER, 
	team_1_possession_percentage INTEGER, 
	team_1_leftside_pass INTEGER, 
	team_1_accurate_fwd_zone_pass INTEGER, 
	team_1_rightside_pass INTEGER, 
	team_1_total_long_balls INTEGER, 
	team_1_total_fwd_zone_pass INTEGER, 
	team_1_touches_in_opp_box INTEGER, 
	team_1_final_third_entries INTEGER, 
	team_1_crosses_18yard INTEGER, 
	team_1_successful_final_third_passes INTEGER, 
	team_1_accurate_cross INTEGER, 
	team_1_long_pass_own_to_opp INTEGER, 
	team_1_fwd_pass INTEGER, 
	team_1_total_cross_nocorner INTEGER, 
	team_1_total_cross INTEGER, 
	team_1_total_final_third_passes INTEGER, 
	team_1_long_pass_own_to_opp_success INTEGER, 
	team_1_poss_lost_all INTEGER, 
	team_1_poss_lost_ctrl INTEGER, 
	team_1_pen_area_entries INTEGER, 
	team_1_passes_left INTEGER, 
	team_1_accurate_long_balls INTEGER, 
	team_1_crosses_18yardplus INTEGER, 
	team_1_accurate_cross_nocorner INTEGER, 
	team_1_attempts_ibox INTEGER, 
	team_1_total_scoring_att INTEGER, 
	team_1_att_openplay INTEGER, 
	team_1_att_lf_target INTEGER, 
	team_1_att_bx_centre INTEGER, 
	team_1_ontarget_scoring_att INTEGER, 
	team_1_ball_recovery INTEGER, 
	team_1_att_lf_total INTEGER, 
	team_1_poss_won_att_3rd INTEGER, 
	team_1_att_ibox_target INTEGER, 
	team_1_ontarget_att_assist INTEGER, 
	team_1_blocked_pass INTEGER, 
	team_1_total_att_assist INTEGER, 
	team_1_duel_won INTEGER, 
	team_1_won_contest INTEGER, 
	team_1_att_sv_low_centre INTEGER, 
	team_1_successful_put_through INTEGER, 
	team_1_total_contest INTEGER, 
	team_1_att_assist_openplay INTEGER, 
	team_1_put_through INTEGER, 
	team_1_poss_won_mid_3rd INTEGER, 
	team_1_total_tackle INTEGER, 
	team_1_interception INTEGER, 
	team_1_interception_won INTEGER, 
	team_1_won_tackle INTEGER, 
	team_1_total_offside INTEGER, 
	team_1_duel_lost INTEGER, 
	team_1_accurate_layoffs INTEGER, 
	team_1_passes_right INTEGER, 
	team_1_total_chipped_pass INTEGER, 
	team_1_total_layoffs INTEGER, 
	team_1_accurate_chipped_pass INTEGER, 
	team_1_aerial_lost INTEGER, 
	team_1_effective_clearance INTEGER, 
	team_1_lost_corners INTEGER, 
	team_1_total_launches INTEGER, 
	team_1_total_clearance INTEGER, 
	team_1_attempts_conceded_ibox INTEGER, 
	team_1_fk_foul_won INTEGER, 
	team_1_poss_won_def_3rd INTEGER, 
	team_1_saved_ibox INTEGER, 
	team_1_saves INTEGER, 
	team_1_diving_save INTEGER, 
	team_1_challenge_lost INTEGER, 
	team_1_dispossessed INTEGER, 
	team_1_unsuccessful_touch INTEGER, 
	team_1_goal_kicks INTEGER, 
	team_1_accurate_goal_kicks INTEGER, 
	team_1_total_keeper_sweeper INTEGER, 
	team_1_attempts_conceded_obox INTEGER, 
	team_1_head_clearance INTEGER, 
	team_1_accurate_keeper_sweeper INTEGER, 
	team_1_effective_head_clearance INTEGER, 
	team_1_fk_foul_lost INTEGER, 
	team_1_attempted_tackle_foul INTEGER, 
	team_1_aerial_won INTEGER, 
	team_1_penalty_conceded INTEGER, 
	team_1_pen_goals_conceded INTEGER, 
	team_1_goals_conceded_ibox INTEGER, 
	team_1_goals_conceded INTEGER, 
	team_1_penalty_faced INTEGER, 
	team_1_total_yel_card INTEGER, 
	team_1_shot_off_target INTEGER, 
	team_1_total_throws INTEGER, 
	team_1_att_rf_total INTEGER, 
	team_1_accurate_throws INTEGER, 
	team_1_att_fastbreak INTEGER, 
	team_1_att_ibox_miss INTEGER, 
	team_1_total_fastbreak INTEGER, 
	team_1_shot_fastbreak INTEGER, 
	team_1_offtarget_att_assist INTEGER, 
	team_1_att_cmiss_high_right INTEGER, 
	team_1_att_miss_high_right INTEGER, 
	team_1_saved_obox INTEGER, 
	team_1_outfielder_block INTEGER, 
	team_1_att_rf_target INTEGER, 
	team_1_corner_taken INTEGER, 
	team_1_won_corners INTEGER, 
	team_1_att_sv_high_centre INTEGER, 
	team_1_accurate_corners_intobox INTEGER, 
	team_1_att_assist_setplay INTEGER, 
	team_1_att_miss_right INTEGER, 
	team_1_att_corner INTEGER, 
	team_1_total_corners_intobox INTEGER, 
	team_1_att_hd_total INTEGER, 
	team_1_att_hd_miss INTEGER, 
	team_1_effective_blocked_cross INTEGER, 
	team_1_blocked_cross INTEGER, 
	team_1_subs_made INTEGER, 
	team_1_accurate_launches INTEGER, 
	team_1_fouled_final_third INTEGER, 
	team_1_att_obx_centre INTEGER, 
	team_1_attempts_obox INTEGER, 
	team_1_att_obox_target INTEGER, 
	team_1_keeper_throws INTEGER, 
	team_1_accurate_keeper_throws INTEGER, 
	team_1_total_through_ball INTEGER, 
	team_1_big_chance_missed INTEGER, 
	team_1_big_chance_created INTEGER, 
	team_1_att_miss_left INTEGER, 
	team_2_formation_used INTEGER, 
	team_2_open_play_pass INTEGER, 
	team_2_leftside_pass INTEGER, 
	team_2_accurate_goal_kicks INTEGER, 
	team_2_possession_percentage INTEGER, 
	team_2_poss_lost_all INTEGER, 
	team_2_goal_kicks INTEGER, 
	team_2_poss_lost_ctrl INTEGER, 
	team_2_total_pass INTEGER, 
	team_2_total_long_balls INTEGER, 
	team_2_total_back_zone_pass INTEGER, 
	team_2_total_chipped_pass INTEGER, 
	team_2_successful_open_play_pass INTEGER, 
	team_2_accurate_long_balls INTEGER, 
	team_2_accurate_back_zone_pass INTEGER, 
	team_2_rightside_pass INTEGER, 
	team_2_unsuccessful_touch INTEGER, 
	team_2_accurate_pass INTEGER, 
	team_2_accurate_chipped_pass INTEGER, 
	team_2_touches INTEGER, 
	team_2_attempts_conceded_ibox INTEGER, 
	team_2_saves INTEGER, 
	team_2_saved_ibox INTEGER, 
	team_2_ball_recovery INTEGER, 
	team_2_challenge_lost INTEGER, 
	team_2_backward_pass INTEGER, 
	team_2_successful_final_third_passes INTEGER, 
	team_2_interception_won INTEGER, 
	team_2_duel_lost INTEGER, 
	team_2_total_fwd_zone_pass INTEGER, 
	team_2_total_layoffs INTEGER, 
	team_2_total_final_third_passes INTEGER, 
	team_2_error_lead_to_shot INTEGER, 
	team_2_fwd_pass INTEGER, 
	team_2_accurate_layoffs INTEGER, 
	team_2_long_pass_own_to_opp INTEGER, 
	team_2_accurate_keeper_throws INTEGER, 
	team_2_accurate_fwd_zone_pass INTEGER, 
	team_2_interception INTEGER, 
	team_2_passes_right INTEGER, 
	team_2_passes_left INTEGER, 
	team_2_keeper_throws INTEGER, 
	team_2_long_pass_own_to_opp_success INTEGER, 
	team_2_put_through INTEGER, 
	team_2_accurate_throws INTEGER, 
	team_2_poss_won_def_3rd INTEGER, 
	team_2_final_third_entries INTEGER, 
	team_2_poss_won_mid_3rd INTEGER, 
	team_2_total_throws INTEGER, 
	team_2_dispossessed INTEGER, 
	team_2_interceptions_in_box INTEGER, 
	team_2_aerial_won INTEGER, 
	team_2_duel_won INTEGER, 
	team_2_pen_area_entries INTEGER, 
	team_2_won_corners INTEGER, 
	team_2_touches_in_opp_box INTEGER, 
	team_2_corner_taken INTEGER, 
	team_2_fk_foul_lost INTEGER, 
	team_2_ontarget_scoring_att INTEGER, 
	team_2_att_hd_target INTEGER, 
	team_2_poss_won_att_3rd INTEGER, 
	team_2_att_assist_openplay INTEGER, 
	team_2_big_chance_missed INTEGER, 
	team_2_total_scoring_att INTEGER, 
	team_2_att_bx_centre INTEGER, 
	team_2_total_corners_intobox INTEGER, 
	team_2_total_cross INTEGER, 
	team_2_total_att_assist INTEGER, 
	team_2_ontarget_att_assist INTEGER, 
	team_2_att_ibox_target INTEGER, 
	team_2_attempts_ibox INTEGER, 
	team_2_att_sv_high_centre INTEGER, 
	team_2_big_chance_created INTEGER, 
	team_2_att_openplay INTEGER, 
	team_2_att_hd_total INTEGER, 
	team_2_total_contest INTEGER, 
	team_2_won_contest INTEGER, 
	team_2_won_tackle INTEGER, 
	team_2_total_tackle INTEGER, 
	team_2_blocked_pass INTEGER, 
	team_2_successful_put_through INTEGER, 
	team_2_att_obox_miss INTEGER, 
	team_2_shot_off_target INTEGER, 
	team_2_attempts_obox INTEGER, 
	team_2_att_obx_centre INTEGER, 
	team_2_att_rf_total INTEGER, 
	team_2_total_cross_nocorner INTEGER, 
	team_2_total_through_ball INTEGER, 
	team_2_crosses_18yard INTEGER, 
	team_2_att_miss_high INTEGER, 
	team_2_fk_foul_won INTEGER, 
	team_2_fouled_final_third INTEGER, 
	team_2_att_corner INTEGER, 
	team_2_aerial_lost INTEGER, 
	team_2_crosses_18yardplus INTEGER, 
	team_2_freekick_cross INTEGER, 
	team_2_contentious_decision INTEGER, 
	team_2_att_ibox_miss INTEGER, 
	team_2_offtarget_att_assist INTEGER, 
	team_2_att_bx_left INTEGER, 
	team_2_penalty_won INTEGER, 
	team_2_att_miss_right INTEGER, 
	team_2_att_cmiss_right INTEGER, 
	team_2_att_pen_goal INTEGER, 
	team_2_att_lf_goal INTEGER, 
	team_2_forward_goals INTEGER, 
	team_2_goals INTEGER, 
	team_2_att_lf_total INTEGER, 
	team_2_att_ibox_goal INTEGER, 
	team_2_big_chance_scored INTEGER, 
	team_2_first_half_goals INTEGER, 
	team_2_att_goal_low_right INTEGER, 
	team_2_total_launches INTEGER, 
	team_2_att_freekick_target INTEGER, 
	team_2_att_obxd_left INTEGER, 
	team_2_att_rf_target INTEGER, 
	team_2_total_flick_on INTEGER, 
	team_2_att_freekick_total INTEGER, 
	team_2_att_obox_target INTEGER, 
	team_2_att_sv_high_left INTEGER, 
	team_2_blocked_scoring_att INTEGER, 
	team_2_att_obox_blocked INTEGER, 
	team_2_attempted_tackle_foul INTEGER, 
	team_2_total_yel_card INTEGER, 
	team_2_total_clearance INTEGER, 
	team_2_effective_clearance INTEGER, 
	team_2_total_pull_back INTEGER, 
	team_2_lost_corners INTEGER, 
	team_2_diving_save INTEGER, 
	team_2_accurate_launches INTEGER, 
	team_2_head_clearance INTEGER, 
	team_2_effective_head_clearance INTEGER, 
	team_2_saved_obox INTEGER, 
	team_2_accurate_cross INTEGER, 
	team_2_accurate_cross_nocorner INTEGER, 
	team_2_attempts_conceded_obox INTEGER, 
	team_2_att_hd_goal INTEGER, 
	team_2_goals_openplay INTEGER, 
	team_2_goal_assist_intentional INTEGER, 
	team_2_goal_assist_openplay INTEGER, 
	team_2_goal_assist INTEGER, 
	team_2_att_goal_high_centre INTEGER, 
	team_2_effective_blocked_cross INTEGER, 
	team_2_blocked_cross INTEGER, 
	team_2_att_ibox_blocked INTEGER, 
	team_2_att_sv_low_right INTEGER, 
	team_2_att_miss_high_left INTEGER, 
	team_2_att_lf_target INTEGER, 
	team_2_att_sv_low_centre INTEGER, 
	team_2_accurate_through_ball INTEGER, 
	team_2_midfielder_goals INTEGER, 
	team_2_att_goal_low_left INTEGER, 
	team_2_att_miss_left INTEGER, 
	team_2_outfielder_block INTEGER, 
	team_2_subs_made INTEGER, 
	team_2_clean_sheet INTEGER, 
	team_2_wins INTEGER, 
	team_2_att_cmiss_left INTEGER, 
	team_2_att_one_on_one INTEGER, 
	PRIMARY KEY (match_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
[2024-05-18T22:06:17.710+0000] {taskinstance.py:1205} INFO - Marking task as FAILED. dag_id=games, task_id=create_db, execution_date=20230101T000000, start_date=20240518T220615, end_date=20240518T220617
[2024-05-18T22:06:17.718+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 481 for task create_db ((psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "pg_type_typname_nsp_index"
DETAIL:  Key (typname, typnamespace)=(games_match_id_seq, 2200) already exists.

[SQL: 
CREATE TABLE games (
	match_id SERIAL NOT NULL, 
	gameweek_id INTEGER, 
	"gameweek_compSeason_label" VARCHAR, 
	"gameweek_compSeason_competition_abbreviation" VARCHAR, 
	"gameweek_compSeason_competition_description" VARCHAR, 
	"gameweek_compSeason_competition_level" VARCHAR, 
	"gameweek_compSeason_competition_source" VARCHAR, 
	"gameweek_compSeason_competition_id" INTEGER, 
	"gameweek_compSeason_id" INTEGER, 
	gameweek_gameweek INTEGER, 
	kickoff_completeness INTEGER, 
	kickoff_millis INTEGER, 
	kickoff_label VARCHAR, 
	"provisionalKickoff_completeness" INTEGER, 
	"provisionalKickoff_millis" INTEGER, 
	"provisionalKickoff_label" VARCHAR, 
	teams_team_1_name VARCHAR, 
	teams_team_1_club_name VARCHAR, 
	"teams_team_1_club_shortName" VARCHAR, 
	teams_team_1_club_abbr VARCHAR, 
	teams_team_1_club_id INTEGER, 
	"teams_team_1_teamType" VARCHAR, 
	"teams_team_1_shortName" VARCHAR, 
	teams_team_1_id INTEGER, 
	teams_score_1 INTEGER, 
	teams_team_2_name VARCHAR, 
	teams_team_2_club_name VARCHAR, 
	"teams_team_2_club_shortName" VARCHAR, 
	teams_team_2_club_abbr VARCHAR, 
	teams_team_2_club_id INTEGER, 
	"teams_team_2_teamType" VARCHAR, 
	"teams_team_2_shortName" VARCHAR, 
	teams_team_2_id INTEGER, 
	teams_score_2 INTEGER, 
	replay BOOLEAN, 
	ground_name VARCHAR, 
	ground_city VARCHAR, 
	ground_source VARCHAR, 
	ground_id INTEGER, 
	"neutralGround" BOOLEAN, 
	status VARCHAR, 
	phase VARCHAR, 
	outcome VARCHAR, 
	attendance INTEGER, 
	clock_secs INTEGER, 
	clock_label VARCHAR, 
	"fixtureType" VARCHAR, 
	"extraTime" BOOLEAN, 
	shootout BOOLEAN, 
	"behindClosedDoors" BOOLEAN, 
	id INTEGER, 
	team_1_formation_used INTEGER, 
	team_1_accurate_back_zone_pass INTEGER, 
	team_1_total_back_zone_pass INTEGER, 
	team_1_accurate_pass INTEGER, 
	team_1_touches INTEGER, 
	team_1_total_pass INTEGER, 
	team_1_backward_pass INTEGER, 
	team_1_successful_open_play_pass INTEGER, 
	team_1_open_play_pass INTEGER, 
	team_1_possession_percentage INTEGER, 
	team_1_leftside_pass INTEGER, 
	team_1_accurate_fwd_zone_pass INTEGER, 
	team_1_rightside_pass INTEGER, 
	team_1_total_long_balls INTEGER, 
	team_1_total_fwd_zone_pass INTEGER, 
	team_1_touches_in_opp_box INTEGER, 
	team_1_final_third_entries INTEGER, 
	team_1_crosses_18yard INTEGER, 
	team_1_successful_final_third_passes INTEGER, 
	team_1_accurate_cross INTEGER, 
	team_1_long_pass_own_to_opp INTEGER, 
	team_1_fwd_pass INTEGER, 
	team_1_total_cross_nocorner INTEGER, 
	team_1_total_cross INTEGER, 
	team_1_total_final_third_passes INTEGER, 
	team_1_long_pass_own_to_opp_success INTEGER, 
	team_1_poss_lost_all INTEGER, 
	team_1_poss_lost_ctrl INTEGER, 
	team_1_pen_area_entries INTEGER, 
	team_1_passes_left INTEGER, 
	team_1_accurate_long_balls INTEGER, 
	team_1_crosses_18yardplus INTEGER, 
	team_1_accurate_cross_nocorner INTEGER, 
	team_1_attempts_ibox INTEGER, 
	team_1_total_scoring_att INTEGER, 
	team_1_att_openplay INTEGER, 
	team_1_att_lf_target INTEGER, 
	team_1_att_bx_centre INTEGER, 
	team_1_ontarget_scoring_att INTEGER, 
	team_1_ball_recovery INTEGER, 
	team_1_att_lf_total INTEGER, 
	team_1_poss_won_att_3rd INTEGER, 
	team_1_att_ibox_target INTEGER, 
	team_1_ontarget_att_assist INTEGER, 
	team_1_blocked_pass INTEGER, 
	team_1_total_att_assist INTEGER, 
	team_1_duel_won INTEGER, 
	team_1_won_contest INTEGER, 
	team_1_att_sv_low_centre INTEGER, 
	team_1_successful_put_through INTEGER, 
	team_1_total_contest INTEGER, 
	team_1_att_assist_openplay INTEGER, 
	team_1_put_through INTEGER, 
	team_1_poss_won_mid_3rd INTEGER, 
	team_1_total_tackle INTEGER, 
	team_1_interception INTEGER, 
	team_1_interception_won INTEGER, 
	team_1_won_tackle INTEGER, 
	team_1_total_offside INTEGER, 
	team_1_duel_lost INTEGER, 
	team_1_accurate_layoffs INTEGER, 
	team_1_passes_right INTEGER, 
	team_1_total_chipped_pass INTEGER, 
	team_1_total_layoffs INTEGER, 
	team_1_accurate_chipped_pass INTEGER, 
	team_1_aerial_lost INTEGER, 
	team_1_effective_clearance INTEGER, 
	team_1_lost_corners INTEGER, 
	team_1_total_launches INTEGER, 
	team_1_total_clearance INTEGER, 
	team_1_attempts_conceded_ibox INTEGER, 
	team_1_fk_foul_won INTEGER, 
	team_1_poss_won_def_3rd INTEGER, 
	team_1_saved_ibox INTEGER, 
	team_1_saves INTEGER, 
	team_1_diving_save INTEGER, 
	team_1_challenge_lost INTEGER, 
	team_1_dispossessed INTEGER, 
	team_1_unsuccessful_touch INTEGER, 
	team_1_goal_kicks INTEGER, 
	team_1_accurate_goal_kicks INTEGER, 
	team_1_total_keeper_sweeper INTEGER, 
	team_1_attempts_conceded_obox INTEGER, 
	team_1_head_clearance INTEGER, 
	team_1_accurate_keeper_sweeper INTEGER, 
	team_1_effective_head_clearance INTEGER, 
	team_1_fk_foul_lost INTEGER, 
	team_1_attempted_tackle_foul INTEGER, 
	team_1_aerial_won INTEGER, 
	team_1_penalty_conceded INTEGER, 
	team_1_pen_goals_conceded INTEGER, 
	team_1_goals_conceded_ibox INTEGER, 
	team_1_goals_conceded INTEGER, 
	team_1_penalty_faced INTEGER, 
	team_1_total_yel_card INTEGER, 
	team_1_shot_off_target INTEGER, 
	team_1_total_throws INTEGER, 
	team_1_att_rf_total INTEGER, 
	team_1_accurate_throws INTEGER, 
	team_1_att_fastbreak INTEGER, 
	team_1_att_ibox_miss INTEGER, 
	team_1_total_fastbreak INTEGER, 
	team_1_shot_fastbreak INTEGER, 
	team_1_offtarget_att_assist INTEGER, 
	team_1_att_cmiss_high_right INTEGER, 
	team_1_att_miss_high_right INTEGER, 
	team_1_saved_obox INTEGER, 
	team_1_outfielder_block INTEGER, 
	team_1_att_rf_target INTEGER, 
	team_1_corner_taken INTEGER, 
	team_1_won_corners INTEGER, 
	team_1_att_sv_high_centre INTEGER, 
	team_1_accurate_corners_intobox INTEGER, 
	team_1_att_assist_setplay INTEGER, 
	team_1_att_miss_right INTEGER, 
	team_1_att_corner INTEGER, 
	team_1_total_corners_intobox INTEGER, 
	team_1_att_hd_total INTEGER, 
	team_1_att_hd_miss INTEGER, 
	team_1_effective_blocked_cross INTEGER, 
	team_1_blocked_cross INTEGER, 
	team_1_subs_made INTEGER, 
	team_1_accurate_launches INTEGER, 
	team_1_fouled_final_third INTEGER, 
	team_1_att_obx_centre INTEGER, 
	team_1_attempts_obox INTEGER, 
	team_1_att_obox_target INTEGER, 
	team_1_keeper_throws INTEGER, 
	team_1_accurate_keeper_throws INTEGER, 
	team_1_total_through_ball INTEGER, 
	team_1_big_chance_missed INTEGER, 
	team_1_big_chance_created INTEGER, 
	team_1_att_miss_left INTEGER, 
	team_2_formation_used INTEGER, 
	team_2_open_play_pass INTEGER, 
	team_2_leftside_pass INTEGER, 
	team_2_accurate_goal_kicks INTEGER, 
	team_2_possession_percentage INTEGER, 
	team_2_poss_lost_all INTEGER, 
	team_2_goal_kicks INTEGER, 
	team_2_poss_lost_ctrl INTEGER, 
	team_2_total_pass INTEGER, 
	team_2_total_long_balls INTEGER, 
	team_2_total_back_zone_pass INTEGER, 
	team_2_total_chipped_pass INTEGER, 
	team_2_successful_open_play_pass INTEGER, 
	team_2_accurate_long_balls INTEGER, 
	team_2_accurate_back_zone_pass INTEGER, 
	team_2_rightside_pass INTEGER, 
	team_2_unsuccessful_touch INTEGER, 
	team_2_accurate_pass INTEGER, 
	team_2_accurate_chipped_pass INTEGER, 
	team_2_touches INTEGER, 
	team_2_attempts_conceded_ibox INTEGER, 
	team_2_saves INTEGER, 
	team_2_saved_ibox INTEGER, 
	team_2_ball_recovery INTEGER, 
	team_2_challenge_lost INTEGER, 
	team_2_backward_pass INTEGER, 
	team_2_successful_final_third_passes INTEGER, 
	team_2_interception_won INTEGER, 
	team_2_duel_lost INTEGER, 
	team_2_total_fwd_zone_pass INTEGER, 
	team_2_total_layoffs INTEGER, 
	team_2_total_final_third_passes INTEGER, 
	team_2_error_lead_to_shot INTEGER, 
	team_2_fwd_pass INTEGER, 
	team_2_accurate_layoffs INTEGER, 
	team_2_long_pass_own_to_opp INTEGER, 
	team_2_accurate_keeper_throws INTEGER, 
	team_2_accurate_fwd_zone_pass INTEGER, 
	team_2_interception INTEGER, 
	team_2_passes_right INTEGER, 
	team_2_passes_left INTEGER, 
	team_2_keeper_throws INTEGER, 
	team_2_long_pass_own_to_opp_success INTEGER, 
	team_2_put_through INTEGER, 
	team_2_accurate_throws INTEGER, 
	team_2_poss_won_def_3rd INTEGER, 
	team_2_final_third_entries INTEGER, 
	team_2_poss_won_mid_3rd INTEGER, 
	team_2_total_throws INTEGER, 
	team_2_dispossessed INTEGER, 
	team_2_interceptions_in_box INTEGER, 
	team_2_aerial_won INTEGER, 
	team_2_duel_won INTEGER, 
	team_2_pen_area_entries INTEGER, 
	team_2_won_corners INTEGER, 
	team_2_touches_in_opp_box INTEGER, 
	team_2_corner_taken INTEGER, 
	team_2_fk_foul_lost INTEGER, 
	team_2_ontarget_scoring_att INTEGER, 
	team_2_att_hd_target INTEGER, 
	team_2_poss_won_att_3rd INTEGER, 
	team_2_att_assist_openplay INTEGER, 
	team_2_big_chance_missed INTEGER, 
	team_2_total_scoring_att INTEGER, 
	team_2_att_bx_centre INTEGER, 
	team_2_total_corners_intobox INTEGER, 
	team_2_total_cross INTEGER, 
	team_2_total_att_assist INTEGER, 
	team_2_ontarget_att_assist INTEGER, 
	team_2_att_ibox_target INTEGER, 
	team_2_attempts_ibox INTEGER, 
	team_2_att_sv_high_centre INTEGER, 
	team_2_big_chance_created INTEGER, 
	team_2_att_openplay INTEGER, 
	team_2_att_hd_total INTEGER, 
	team_2_total_contest INTEGER, 
	team_2_won_contest INTEGER, 
	team_2_won_tackle INTEGER, 
	team_2_total_tackle INTEGER, 
	team_2_blocked_pass INTEGER, 
	team_2_successful_put_through INTEGER, 
	team_2_att_obox_miss INTEGER, 
	team_2_shot_off_target INTEGER, 
	team_2_attempts_obox INTEGER, 
	team_2_att_obx_centre INTEGER, 
	team_2_att_rf_total INTEGER, 
	team_2_total_cross_nocorner INTEGER, 
	team_2_total_through_ball INTEGER, 
	team_2_crosses_18yard INTEGER, 
	team_2_att_miss_high INTEGER, 
	team_2_fk_foul_won INTEGER, 
	team_2_fouled_final_third INTEGER, 
	team_2_att_corner INTEGER, 
	team_2_aerial_lost INTEGER, 
	team_2_crosses_18yardplus INTEGER, 
	team_2_freekick_cross INTEGER, 
	team_2_contentious_decision INTEGER, 
	team_2_att_ibox_miss INTEGER, 
	team_2_offtarget_att_assist INTEGER, 
	team_2_att_bx_left INTEGER, 
	team_2_penalty_won INTEGER, 
	team_2_att_miss_right INTEGER, 
	team_2_att_cmiss_right INTEGER, 
	team_2_att_pen_goal INTEGER, 
	team_2_att_lf_goal INTEGER, 
	team_2_forward_goals INTEGER, 
	team_2_goals INTEGER, 
	team_2_att_lf_total INTEGER, 
	team_2_att_ibox_goal INTEGER, 
	team_2_big_chance_scored INTEGER, 
	team_2_first_half_goals INTEGER, 
	team_2_att_goal_low_right INTEGER, 
	team_2_total_launches INTEGER, 
	team_2_att_freekick_target INTEGER, 
	team_2_att_obxd_left INTEGER, 
	team_2_att_rf_target INTEGER, 
	team_2_total_flick_on INTEGER, 
	team_2_att_freekick_total INTEGER, 
	team_2_att_obox_target INTEGER, 
	team_2_att_sv_high_left INTEGER, 
	team_2_blocked_scoring_att INTEGER, 
	team_2_att_obox_blocked INTEGER, 
	team_2_attempted_tackle_foul INTEGER, 
	team_2_total_yel_card INTEGER, 
	team_2_total_clearance INTEGER, 
	team_2_effective_clearance INTEGER, 
	team_2_total_pull_back INTEGER, 
	team_2_lost_corners INTEGER, 
	team_2_diving_save INTEGER, 
	team_2_accurate_launches INTEGER, 
	team_2_head_clearance INTEGER, 
	team_2_effective_head_clearance INTEGER, 
	team_2_saved_obox INTEGER, 
	team_2_accurate_cross INTEGER, 
	team_2_accurate_cross_nocorner INTEGER, 
	team_2_attempts_conceded_obox INTEGER, 
	team_2_att_hd_goal INTEGER, 
	team_2_goals_openplay INTEGER, 
	team_2_goal_assist_intentional INTEGER, 
	team_2_goal_assist_openplay INTEGER, 
	team_2_goal_assist INTEGER, 
	team_2_att_goal_high_centre INTEGER, 
	team_2_effective_blocked_cross INTEGER, 
	team_2_blocked_cross INTEGER, 
	team_2_att_ibox_blocked INTEGER, 
	team_2_att_sv_low_right INTEGER, 
	team_2_att_miss_high_left INTEGER, 
	team_2_att_lf_target INTEGER, 
	team_2_att_sv_low_centre INTEGER, 
	team_2_accurate_through_ball INTEGER, 
	team_2_midfielder_goals INTEGER, 
	team_2_att_goal_low_left INTEGER, 
	team_2_att_miss_left INTEGER, 
	team_2_outfielder_block INTEGER, 
	team_2_subs_made INTEGER, 
	team_2_clean_sheet INTEGER, 
	team_2_wins INTEGER, 
	team_2_att_cmiss_left INTEGER, 
	team_2_att_one_on_one INTEGER, 
	PRIMARY KEY (match_id)
)

]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 74)
[2024-05-18T22:06:17.764+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2024-05-18T22:06:17.781+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-18T22:06:17.783+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-18T22:33:40.989+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-18T22:33:41.007+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:33:41.012+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:33:41.013+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 1
[2024-05-18T22:33:41.023+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): create_db> on 2023-01-01 00:00:00+00:00
[2024-05-18T22:33:41.029+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=111) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-18T22:33:41.030+0000] {standard_task_runner.py:63} INFO - Started process 121 to run task
[2024-05-18T22:33:41.031+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'games', 'create_db', 'scheduled__2023-01-01T00:00:00+00:00', '--job-id', '509', '--raw', '--subdir', 'DAGS_FOLDER/get_main_games.py', '--cfg-path', '/tmp/tmpt9fq65nv']
[2024-05-18T22:33:41.031+0000] {standard_task_runner.py:91} INFO - Job 509: Subtask create_db
[2024-05-18T22:33:41.057+0000] {task_command.py:426} INFO - Running <TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [running]> on host 256b22cb9d78
[2024-05-18T22:33:41.103+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='games' AIRFLOW_CTX_TASK_ID='create_db' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:00:00+00:00'
[2024-05-18T22:33:41.103+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-18T22:33:41.120+0000] {base.py:84} INFO - Using connection ID '***' for task execution.
[2024-05-18T22:33:42.369+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-18T22:33:42.370+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-18T22:33:42.377+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=games, task_id=create_db, execution_date=20230101T000000, start_date=20240518T223341, end_date=20240518T223342
[2024-05-18T22:33:42.405+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-18T22:33:42.424+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-18T22:33:42.424+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-05-18T22:34:29.448+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-05-18T22:34:29.464+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:34:29.469+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [queued]>
[2024-05-18T22:34:29.469+0000] {taskinstance.py:2303} INFO - Starting attempt 1 of 1
[2024-05-18T22:34:29.477+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): create_db> on 2023-01-01 00:00:00+00:00
[2024-05-18T22:34:29.484+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61: DeprecationWarning: This process (pid=131) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-05-18T22:34:29.485+0000] {standard_task_runner.py:63} INFO - Started process 142 to run task
[2024-05-18T22:34:29.485+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'games', 'create_db', 'scheduled__2023-01-01T00:00:00+00:00', '--job-id', '510', '--raw', '--subdir', 'DAGS_FOLDER/get_main_games.py', '--cfg-path', '/tmp/tmpp261wt2h']
[2024-05-18T22:34:29.486+0000] {standard_task_runner.py:91} INFO - Job 510: Subtask create_db
[2024-05-18T22:34:29.515+0000] {task_command.py:426} INFO - Running <TaskInstance: games.create_db scheduled__2023-01-01T00:00:00+00:00 [running]> on host 256b22cb9d78
[2024-05-18T22:34:29.568+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='games' AIRFLOW_CTX_TASK_ID='create_db' AIRFLOW_CTX_EXECUTION_DATE='2023-01-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-01-01T00:00:00+00:00'
[2024-05-18T22:34:29.569+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-05-18T22:34:29.584+0000] {base.py:84} INFO - Using connection ID '***' for task execution.
[2024-05-18T22:34:30.873+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-05-18T22:34:30.875+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-05-18T22:34:30.883+0000] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=games, task_id=create_db, execution_date=20230101T000000, start_date=20240518T223429, end_date=20240518T223430
[2024-05-18T22:34:30.940+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-05-18T22:34:30.960+0000] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-18T22:34:30.961+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
